import glob from'glob';import fs from'fs';import path from'path';var sep=path.sep;var searchEntries=function searchEntries(options){var files={};// 如果目录以'/'结尾，则去掉
options.entryPath=options.entryPath.replace(/\/$/,'');/**
   * fileNamePrefix 表示输出文件的前缀
   * 如输出'app/js/default/index.js',则前缀为'app/js/default/'
   */var pattern='';if(options.fileType=='less'){pattern=options.entryPath+'/'+options.fileName+'*.less';}else if(options.isFuzzy){pattern=options.entryPath+'/**/'+options.fileName+'.{js,jsx}';}else{pattern=options.entryPath+'/'+options.fileName+'.{js,jsx}';}glob.sync(pattern).forEach(function(file){var entryName=options.fileNamePrefix+file.replace(options.entryPath+'/','').replace(file.substring(file.lastIndexOf('.')),'');files[entryName]=file;});return files;};// 判断文件或文件夹是否存在
var fsExistsSync=function fsExistsSync(path){try{fs.accessSync(path,fs.F_OK);}catch(e){return false;}return true;};var searchDirs=function searchDirs(searchDir,isExistDir){var dirsArr=[];if(!fsExistsSync(searchDir)){return[];}var dirs=fs.readdirSync(searchDir);dirs=dirs.filter(function(dir){return dir!=='.DS_Store'&&dir!=='.gitkeep'&&fsExistsSync(searchDir+'/'+dir+'/'+isExistDir);});dirsArr=dirs.map(function(dir){return searchDir+'/'+dir;});return dirsArr;};// 需要忽略的目录
var searchIgnoreDirs=function searchIgnoreDirs(searchDir,watchDirs){var dirsArr=[];if(!fsExistsSync(searchDir)){return[];};var dirs=fs.readdirSync(searchDir);dirs=dirs.filter(function(dir){return dir!=='.DS_Store'&&dir!=='.gitkeep'&&watchDirs.indexOf(dir)===-1;});dirsArr=dirs.map(function(dir){return searchDir+'/'+dir;});return dirsArr;};var isArray=function isArray(arr){return Object.prototype.toString.call(arr)==='[object Array]';};var isEmptyObject=function isEmptyObject(obj){for(var item in obj){return false;}return true;};var firstUpperCase=function firstUpperCase(str){return str.toLowerCase().replace(/( |^)[a-z]/g,function(L){return L.toUpperCase();});};var filterObject=function filterObject(obj,filterName){var newObj={};var filterObj={};var filterArr=filterName.split(',');for(var item in obj){if(filterArr.indexOf(item)===-1){newObj[item]=obj[item];}else{filterObj[item]=obj[item];}}return{newObj:newObj,filterObj:filterObj};};var isPlugin=function isPlugin(path){return path.indexOf('Plugin')!==-1;};var isBundle=function isBundle(path){return path.indexOf('Bundle')!==-1;};var isTheme=function isTheme(path){var finalPath=path.split(sep).join('/');return finalPath.indexOf('web/themes')!==-1;};var isActivity=function isActivity(path){return path.indexOf('activities')!==-1;};export{searchEntries,searchDirs,searchIgnoreDirs,fsExistsSync,isArray,isEmptyObject,firstUpperCase,filterObject,isPlugin,isBundle,isTheme,isActivity};